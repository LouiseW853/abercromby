<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <!-- This is a wide open CSP declaration. To lock this down for production, see below. -->
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *" />
    <!-- Good default declaration:
   * gap: is required only on iOS (when using UIWebView) and is needed for JS->native communication
   * https://ssl.gstatic.com is required only on Android and is needed for TalkBack to function properly
   * Disables use of eval() and inline scripts in order to mitigate risk of XSS vulnerabilities. To change this:
       * Enable inline JS: add 'unsafe-inline' to default-src
       * Enable eval(): add 'unsafe-eval' to default-src
   * Create your own at http://cspisawesome.com
   -->
    <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: 'unsafe-inline' https://ssl.gstatic.com; style-src 'self' 'unsafe-inline'; media-src *" /> -->

    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <title>On the Go</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script>
    $(document).ready(function()
    {

    $("#login").click(function(){
      var username=$("#username").val();
      var password=$("#password").val();
      var dataString="username="+username+"&password="+password+"&login=";
        if($.trim(username).length>0 & $.trim(password).length>0)
        {
          $.ajax({
            type: "POST",
            url:"https://devweb2015.cis.strath.ac.uk/~trb13189/Abercromby/login.php",
            data: dataString,
            crossDomain: true,
            cache: false,
            beforeSend: function(){ $("#login").val('Connecting...');},
            success: function(data){
            if(data=="success")
            {
              window.localStorage.setItem("loggedIn", "1");
              localStorage.login="true";
              localStorage.username=username;
              window.location.href = "main.html";
            }
            else if(data=="failed")
            {
            alert("Username or password is not correct");
            }
          }
          });
          }return false;
          });
          });


          </script>
    </script>
</head>

<body>
  <section id = "maincontent">
<div class = "app">
    <br>
    <img id = "image-logo" src="img/logo.png" alt = "On The Go">
    <br>

  <h2>Username:</h2>
     <input type = "text" id = "username"  class = "entrybox">
  <br>
  <h2>Password:</h2>
  <input type = "password" id = "password" class = "entrybox">
  <br>
  <br>
 <input type = "button" id = "login" value = "Log In" class = "button"></input>
  <br>
  <br>
  <br>
  <a href = "signup.html"> <button class = "buttonblue" id = "register" > Register </button></a>
</div>
</section>


    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
        app.initialize();
    </script>
</body>
</html>
